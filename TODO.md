# TODO

- [ ] JPEGli in SVG with mask smaller than WebP?
- [ ] Improve HasTransparency detection (for all format decoding)
- [ ] Move component/decode.go#decodeImage to internal/images/decode.go?
- [ ] Fix XMP inject/extract tests
- [ ] Don't re-encode same-same format. (eg. USDZ to Web(no alpha, lossy); Web to Web)
- [ ] Read XMP data from generic JPEG format (eg. with EXIF APP1 chunk before XMP APP1 chunk)
- [ ] Show warning when using fallback size to generate USDZ
- [ ] Show warning when losing information on conversion (are there any of these cases now?)
- [ ] Store number of sides in the Metadata
- [ ] Validate the number of sides in the metadata with the number of images provided
- [ ] Allow conversion of postcard files on PostOffice
- [ ] Coregistration of front and back (slight rotation & translation differences)
- [ ] Allow uploading/choice of SVGs for the back side, to make a "blank" postcard
  - [ ] Responsive layout for the back — in physical units
  - [ ] Rendering SVG inside go/wasm
- [ ] Allow secrets to be unselected in #PostOffice UI
- [ ] Figure out why secrets dragging is janky #PostOffice
- [ ] Allow secrets region selection on touch devices #PostOffice
- [ ] Only one postcards.css per group/directory

## Done

- [x] Auto-transparency
- [x] Add thickness & paper colour to Metadata
- [x] Align YAML & JSON formats
  - [x] YAML output for front-dimensions
- [x] Force `-only` cards to be FlipNone
- [x] Swap to Annotations for locales (to allow XMP to be HTML-free)
- [x] Secret areas
- [x] Paper edge colour #usd
- [x] Move to using JPEGli for smaller filesizes
- [x] Add XMP to web JPG & PNG output #xmp
- [x] XMP decoder #xmp
- [x] Throw error on invalid flip
- [x] Compile without CGO
- [x] Read XMP data from WebP `web` format
- [x] Read XMP data from JPEG `web` format
- [x] Decode USD & USDZ #usd
- [x] Creating a USD(Z) from an image that doesn't have resolution data (eg front/back portrait fixtures) seems to nil pointer fail. #bug
- [x] Get this CLI tool building automatically
- [x] Web (webp) with transparency not convertible (eg. to USD) #bug
- [x] Create USDZ directly (no need for OpenUSD tooling)
- [x] Show images when chosen in PostOffice
- [x] Allow selection of secrets in PostOffice
- [x] Put buttons for downloading CSS and HTML on web-js output (PostOffice)
- [x] Figure out USD format
  - [x] Add colour to postcard edges
  - [x] Calendar flip cards
  - [x] No flip cards
- [x] Fix blob image display from ServiceWorker #bug #postoffice
- [x] How to handle refreshing ServiceWorker WASM on update?
  - Cache is busted automatically every 24 hours [by the browser](https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/update#:~:text=fetch%20occurred%20over-,24%20hours%20ago,-.).
- [x] Show useful errors on build fail #PostOffice
- [x] Read XMP data from png `web` format
- [x] Transparent bordered #USD postcards
- [x] Get HTML format to output the _right_ image extension (fill out ImageExt argument)
- [x] Created USDZs are technically invalid (byte alignment) — can I tweak the output of archive/zip? Or do I need for fork it?
- [x] Determine what this `usdchecker` error means & fix it:
  - `Found material bindings but no MaterialBindingAPI applied on the prim </Postcard/Geom/Front>. (fails 'MaterialBindingAPIAppliedChecker')`
